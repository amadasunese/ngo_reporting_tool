{% extends "base.html" %}
{% block title %}Activities{% endblock %}
{% block content %}
<div class="card">
  <div style="display:flex; justify-content:space-between; align-items:center;">
    <h1>Activities</h1>
    <a class="btn" href="/activities/create">+ New Activity</a>
  </div>

  <div class="grid" style="margin-top:10px;">
    <form method="get">
      <label>Filter by Project</label>
      <select name="project_id" onchange="this.form.submit()">
        <option value="">All Projects</option>
        {% for p in projects %}
          <option value="{{p.id}}" {% if project_id==p.id %}selected{% endif %}>{{p.name}}</option>
        {% endfor %}
      </select>
    </form>

    <form method="get">
      <label>Filter by SO</label>
      <select name="so_id" onchange="this.form.submit()">
        <option value="">All SOs</option>
        {% for s in sos %}
          <option value="{{s.id}}" {% if so_id==s.id %}selected{% endif %}>{{s.so_code}} - {{s.title}}</option>
        {% endfor %}
      </select>
    </form>
  </div>

  {% if not activities %}
    <p style="margin-top:10px;">No activities yet.</p>
  {% else %}
    <table style="margin-top:10px;">
      <thead><tr><th>Date</th><th>Code</th><th>Title</th><th>SO</th><th>Status</th><th></th></tr></thead>
      <tbody>
        {% for a in activities %}
          <tr>
            <td>{{ a.activity_date }}</td>
            <td>{{ a.activity_code or "â€”" }}</td>
            <td><a href="/activities/{{a.id}}">{{ a.title }}</a></td>
            <td>{{ a.strategic_objective.so_code }}</td>
            <td>{{ a.status }}</td>
            <td><a href="/activities/{{a.id}}/edit">Edit</a></td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  {% endif %}
</div>
{% endblock %}
