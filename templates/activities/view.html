{% extends "base.html" %}
{% block title %}Activity{% endblock %}
{% block content %}
<div class="card">
  <div style="display:flex; justify-content:space-between; align-items:center;">
    <h1>{{ activity.activity_code or "Activity" }} — {{ activity.title }}</h1>
    <div>
      <a class="btn" href="/activities/{{activity.id}}/edit">Edit</a>
      <form method="post" action="/activities/{{activity.id}}/delete" style="display:inline;">
    {% if csrf_token is defined %}<input type="hidden" name="csrf_token" value="{{ csrf_token() }}">{% endif %}

        <button style="background:#ef4444;" type="submit">Delete</button>
      </form>
    </div>
  </div>

  <p><b>Date:</b> {{ activity.activity_date }} | <b>Location:</b> {{ activity.location or "—" }} | <b>Status:</b> {{ activity.status }}</p>
  <p><b>SO:</b> {{ activity.strategic_objective.so_code }} — {{ activity.strategic_objective.title }}</p>
  <p><b>Indicator:</b>
    {% if activity.indicator %}
      {{ activity.indicator.indicator_code }} — {{ activity.indicator.statement }}
    {% else %}
      — None —
    {% endif %}
  </p>
  <p><b>Description:</b> {{ activity.description or "—" }}</p>
</div>

<div class="grid">
  <div class="card">
    <h3>Reach (Attendance)</h3>
    <p><b>Male:</b> {{ reach.male }} | <b>Female:</b> {{ reach.female }} | <b>Total:</b> {{ reach.total }}</p>

    <form method="post" action="/activities/{{activity.id}}/attendance">
    {% if csrf_token is defined %}<input type="hidden" name="csrf_token" value="{{ csrf_token() }}">{% endif %}

      <div class="grid">
        <div>
          <label>Male count</label>
          <input type="number" min="0" name="male_count" value="{{ attendance_row.male_count if attendance_row else 0 }}">
        </div>
        <div>
          <label>Female count</label>
          <input type="number" min="0" name="female_count" value="{{ attendance_row.female_count if attendance_row else 0 }}">
        </div>
      </div>
      <button type="submit">Save Attendance</button>
    </form>
  </div>

  <div class="card">
    <h3>Quick links</h3>
    <p><a href="/activities/?so_id={{activity.strategic_objective_id}}">View other activities in this SO →</a></p>
    {% if activity.indicator_id %}
      <p><a href="/indicators/{{activity.indicator_id}}">View linked indicator →</a></p>
    {% endif %}
  </div>
</div>
{% endblock %}
